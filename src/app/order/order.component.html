<form [formGroup]="orderForm" (ngSubmit)="onSubmit()">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Order details</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div fxLayout="column wrap" fxLayoutAlign="start" fxLayoutGap="10px" formArrayName="items">
        <div fxLayout="row wrap" fxLayoutAlign="start" fxLayoutGap="10px" *ngFor="let itemForm of itemFormArray.controls; let i=index" [formGroupName]="i">
          <mat-form-field fxFlex>
            <mat-label>Item</mat-label>
            <input matInput placeholder="Item" formControlName="item" />
          </mat-form-field>
  
          <mat-form-field fxFlex="12">
            <mat-label>Unit</mat-label>
            <mat-select placeholder="Unit" formControlName="unit">
              <mat-option *ngFor="let unit of units" [value]="unit.abbreviation">
                {{ unit.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field fxFlex="12" *ngIf="itemForm.controls['unit'].value==='wi'">
            <mat-label>Weight</mat-label>
            <input type="number" matInput placeholder="Weight" min="0" formControlName="weight" />
            <span matSuffix>lbs</span>
          </mat-form-field>

          <mat-form-field fxFlex="12" *ngIf="itemForm.controls['unit'].value==='si'">
            <mat-label>Size</mat-label>
            <mat-select placeholder="Size" formControlName="size">
              <mat-option *ngFor="let size of sizes" [value]="size.abbreviation">
                {{ size.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field fxFlex="8">
            <mat-label>Quantity</mat-label>
            <input type="number" matInput placeholder="Quantity" min="0" formControlName="quantity" />
          </mat-form-field>
          
          <button mat-icon-button matTooltip="Add item" type="button" *ngIf="i==itemFormArray.length-1" (click)="addItemAt()">
            <mat-icon>add</mat-icon>
          </button>

          <button mat-icon-button matTooltip="Remove item" type="button" (click)="removeItemAt(i)" *ngIf="itemFormArray.length>1">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </div>
    </mat-card-content>
    <mat-card-actions fxLayoutAlign="end">
      <button mat-raised-button color="primary" type="submit">Checkout</button>
    </mat-card-actions>
  </mat-card>
</form>